params:
  click: { select: single }
  domain: [sun, fog, drizzle, rain, snow]
  colors: ['#e7ba52', '#a7a7a7', '#aec7e8', '#1f77b4', '#9467bd']
vconcat:
- hconcat:
  - plot:
    - mark: dot
      data: { from: weather, filterBy: $click }
      x: { dateMonthDay: date }
      y: temp_max
      fill: weather
      r: precipitation
      opacity: 0.7
    - select: intervalX
      as: $range
    - select: highlight
      by: $range
      fill: '#eee'
    - legend: color
      as: $click
      columns: 1
    domainXY: Fixed
    tickFormatX: '%b'
    domainColor: $domain
    rangeColor: $colors
    domainR: Fixed
    rangeR: [2, 10]
    width: 800
- plot:
  - mark: barX
    data: { from: weather }
    x: { count: }
    y: weather
    fill: '#f5f5f5'
  - mark: barX
    data: { from: weather, filterBy: $range }
    x: { count: }
    y: weather
    fill: weather
    order: weather
  - select: toggleY
    as: $click
  - select: highlight
    by: $click
  domainX: Fixed
  domainY: $domain
  labelY: null
  domainColor: $domain
  rangeColor: $colors
  width: 800