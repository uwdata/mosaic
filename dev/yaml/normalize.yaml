data:
  stocks: { file: data/stocks.csv }
  labels: SELECT MAX(Date) as Date, ARGMAX(Close, Date) AS Close, Symbol
          FROM stocks GROUP BY Symbol
params:
  point: { date: '2013-05-13' }
plot:
- mark: ruleX
  x: $point
- mark: textX
  x: $point
  text: $point
  frameAnchor: top
  lineAnchor: bottom
  dy: -7
- mark: text
  data: { from: labels }
  x: Date
  y: { expr: Close / (SELECT MAX(Close) FROM stocks WHERE Symbol = source.Symbol AND Date = $point) }
  dx: 2
  text: Symbol
  fill: Symbol
  textAnchor: start
- mark: lineY
  data: { from: stocks }
  x: Date
  y: { expr: Close / (SELECT MAX(Close) FROM stocks WHERE Symbol = source.Symbol AND Date = $point) }
  stroke: Symbol
- select: nearestX
  as: $point
scaleY: log
domainY: [0.2, 6]
gridY: true
labelX: null
labelY: null
tickFormatY: '%'
width: 650
height: 400
marginRight: 35